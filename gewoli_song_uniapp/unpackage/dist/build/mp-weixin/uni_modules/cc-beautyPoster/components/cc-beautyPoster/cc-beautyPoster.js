(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["uni_modules/cc-beautyPoster/components/cc-beautyPoster/cc-beautyPoster"],{"17e4":function(t,e,o){"use strict";(function(t,i){var n=o("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s,a=n(o("9523")),c=n(o("1e0e")),l=(s={mixins:[{methods:{setData:function(t,e){var o=this;Object.keys(t).forEach((function(e){var i,n,s=t[e];e=e.replace(/\]/g,"").replace(/\[/g,".");var a=e.lastIndexOf(".");-1!=a?(n=e.slice(a+1),i=function(t,e,o){return e=e.split("."),e.forEach((function(e){if(null===t[e]||void 0===t[e]){t[e]=/^[0-9]+$/.test(o)?[]:{},t=t[e]}else t=t[e]})),t}(o,e.slice(0,a),n)):(n=e,i=o),i.$data&&void 0===i.$data[n]?(Object.defineProperty(i,n,{get:function(){return i.$data[n]},set:function(t){i.$data[n]=t,o.$forceUpdate()},enumerable:!0,configurable:!0}),i[n]=s):o.$set(i,n,s)})),function(t){return"function"==typeof t||!1}(e)&&this.$nextTick(e)}}}],data:function(){return{windowWidth:"",windowHeight:"",colors:"red",ctx:"",imgUrl:"",isShow:!1,canvasShow:!0}},props:{posterData:{type:Object}},created:function(){this.getSystem(),this.setPoster()},onShareAppMessage:function(t){return{title:(void 0).posterData.title,path:"/pages/tabbar/index/index",imageUrl:(void 0).posterData.img}},onReachBottom:function(){}},(0,a.default)(s,"onShareAppMessage",(function(){})),(0,a.default)(s,"methods",{getSystem:function(){var e=this;t.getSystemInfo({success:function(t){console.log(t),e.setData({windowHeight:t.windowHeight,windowWidth:t.windowWidth})}})},setPoster:function(){t.showLoading({title:"海报生成中..."});var e=t.createCanvasContext("mycanvas",this);e.fillStyle="#FFFFFF",e.fillRect(0,0,this.windowWidth-60,520);var o=function(t,e,o,i,n,s,a){t.setFillStyle(o),t.setTextAlign("left"),t.font=a?"normal bold 20px Arial,sans-serif":"normal 20px Arial,sans-serif",t.setFontSize(e),t.fillText(s,i,n),t.restore()};o(e,14,"#333",85,35,this.posterData.name,"bold"),o(e,12,"#999",85,58,this.posterData.title),e.save(),e.beginPath();this.setRadius(e,60,60,15,15,8),this.setGoodsImg(e);this.posterData.money;this.setGoodsName(e)},setEwm:function(e){var o=this;console.log("生成二维码");this.windowWidth;console.log(this.windowWidth),c.default.make({canvasId:"mycanvas",componentInstance:this,text:this.posterData.url,size:200,margin:10,fileType:"png",success:function(i){console.log("生成二维码3"),console.log("res = "+i),setTimeout((function(){o.canvasShow=!1,e.save(),e.draw(!1,(function(){setTimeout((function(){t.canvasToTempFilePath({canvasId:"mycanvas",success:function(t){console.log(t),o.imgUrl=t.tempFilePath}},o)}),300)})),t.hideLoading()}),1e3)},complete:function(){}})},setRadius:function(t,e,o,i,n,s){t.arc(i+s,n+s,s,Math.PI,3*Math.PI/2),t.lineTo(e-s+i,n),t.arc(e-s+i,s+n,s,3*Math.PI/2,2*Math.PI),t.lineTo(e+i,o+n-s),t.arc(e-s+i,o-s+n,s,0,1*Math.PI/2),t.lineTo(s+i,o+n),t.arc(s+i,o-s+n,s,1*Math.PI/2,Math.PI),t.strokeStyle="#fff",t.fill(),t.clip(),t.drawImage(this.posterData.logo,i,n,e,o),t.closePath(),t.restore()},setCircular:function(t,e,o,i,n){t.arc(e/2+i,o/2+n,e/2,0,2*Math.PI,!1),t.strokeStyle="#fff",t.fill(),t.clip(),t.drawImage(this.posterData.logo,i,n,e,o),t.closePath(),t.restore()},setGoodsImg:function(t){var e=this.windowWidth-90;t.drawImage(this.posterData.img,15,95,e,350),t.save()},setGoodsName:function(e){var o=this;if(this.posterData.remark)for(var i={x:20,y:470,width:210,height:20,line:2,color:"#202020",size:14,align:"left",baseline:"top",text:this.posterData.remark,bold:!0},n=Math.ceil(i.width/i.size),s=Math.ceil(i.text.length/n),a=0;a<s;a++){var c={x:i.x,y:i.y+a*i.height,color:i.color,size:i.size,align:i.align,baseline:i.baseline,text:i.text.substring(a*n,(a+1)*n),bold:i.bold};a<i.line&&(a==i.line-1&&(c.text=c.text.substring(0,c.text.length-3)+"......"),this.drawText(e,c))}setTimeout((function(){o.canvasShow=!1,e.save(),e.draw(!1,(function(){setTimeout((function(){t.canvasToTempFilePath({canvasId:"mycanvas",success:function(t){console.log(t),o.imgUrl=t.tempFilePath}},o)}),300)})),t.hideLoading()}),1e3)},drawText:function(t,e){console.log("渲染文字",e),t.save(),t.setFillStyle(e.color),t.setFontSize(e.size),t.setTextAlign(e.align),t.setTextBaseline(e.baseline),e.bold&&(console.log("字体加粗"),t.fillText(e.text,e.x,e.y-.1),t.fillText(e.text,e.x-.1,e.y)),t.fillText(e.text,e.x,e.y),e.bold&&(t.fillText(e.text,e.x,e.y+.1),t.fillText(e.text,e.x+.1,e.y)),t.restore()},saveImg:function(){t.showLoading({title:"保存中..."});var e=this;t.getSetting({success:function(o){t.hideLoading(),console.log(o),o.authSetting["scope.writePhotosAlbum"]?setTimeout((function(){t.saveImageToPhotosAlbum({filePath:e.imgUrl,success:function(e){t.hideLoading(),t.showToast({title:"保存成功",icon:"success"})},fail:function(e){console.log(e),t.showToast({title:"保存失败",icon:"none"})}})}),1e3):i.authorize({scope:"scope.writePhotosAlbum",success:function(t){console.log(t)}})}})}}),s);e.default=l}).call(this,o("543d")["default"],o("bc2e")["default"])},3609:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return n})),o.d(e,"a",(function(){}));var i=function(){var t=this.$createElement;this._self._c},n=[]},"60a7":function(t,e,o){"use strict";o.r(e);var i=o("17e4"),n=o.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},a3cd3:function(t,e,o){},d425:function(t,e,o){"use strict";o.r(e);var i=o("3609"),n=o("60a7");for(var s in n)["default"].indexOf(s)<0&&function(t){o.d(e,t,(function(){return n[t]}))}(s);o("e017");var a=o("f0c5"),c=Object(a["a"])(n["default"],i["b"],i["c"],!1,null,"53d0b1eb",null,!1,i["a"],void 0);e["default"]=c.exports},e017:function(t,e,o){"use strict";var i=o("a3cd3"),n=o.n(i);n.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'uni_modules/cc-beautyPoster/components/cc-beautyPoster/cc-beautyPoster-create-component',
    {
        'uni_modules/cc-beautyPoster/components/cc-beautyPoster/cc-beautyPoster-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("d425"))
        })
    },
    [['uni_modules/cc-beautyPoster/components/cc-beautyPoster/cc-beautyPoster-create-component']]
]);
