(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/submit"],{"0965":function(t,n,e){"use strict";e.r(n);var i=e("3bb2"),o=e("7d42");for(var u in o)["default"].indexOf(u)<0&&function(t){e.d(n,t,(function(){return o[t]}))}(u);e("9903");var a=e("f0c5"),r=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"6de26fe6",null,!1,i["a"],void 0);n["default"]=r.exports},"3bb2":function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return u})),e.d(n,"a",(function(){return i}));var i={uIcon:function(){return e.e("uview-ui/components/u-icon/u-icon").then(e.bind(null,"7154"))},uGap:function(){return e.e("uview-ui/components/u-gap/u-gap").then(e.bind(null,"7593"))},uNumberBox:function(){return e.e("uview-ui/components/u-number-box/u-number-box").then(e.bind(null,"7fb0"))},uField:function(){return e.e("uview-ui/components/u-field/u-field").then(e.bind(null,"13f3"))},uButton:function(){return e.e("uview-ui/components/u-button/u-button").then(e.bind(null,"d89e"))},uTopTips:function(){return e.e("uview-ui/components/u-top-tips/u-top-tips").then(e.bind(null,"e470"))},uniPopup:function(){return e.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(e.bind(null,"f8c6"))}},o=function(){var t=this.$createElement;this._self._c},u=[]},"3fdc":function(t,n,e){},"7d42":function(t,n,e){"use strict";e.r(n);var i=e("8dc5"),o=e.n(i);for(var u in i)["default"].indexOf(u)<0&&function(t){e.d(n,t,(function(){return i[t]}))}(u);n["default"]=o.a},"8dc5":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e={data:function(){return{goodsData:{},city:"请选择地址",addressId:"",address:"",contacts:"请选择地址",remark:"",cPrice:0,addressObj:{},consignee:""}},onLoad:function(t){var n=JSON.parse(t.obj);n.buyQuantity=1,this.goodsData=n,this.init()},onShow:function(){var t=getCurrentPages();if(null!=t){var n=t[t.length-1],e=n.data.addressObj;console.log(e),this.city="".concat(e.provinceState,",").concat(e.city,",").concat(e.area),this.addressId=e.id,this.contacts=e.phoneNumber,this.address=e.addressLine,this.consignee=e.recipientName}},watch:{goodsData:{handler:function(t){var n=t.goodsCurrentPrice*t.buyQuantity;this.cPrice=n.toFixed(2)},deep:!0}},methods:{open:function(){this.$refs.popup.open()},createOrder:function(n){var e=this;if(this.city){var i={address:this.city+" "+this.address,amount:this.cPrice,buyQuantity:this.goodsData.buyQuantity,consignee:this.consignee,goodsId:this.goodsData.id,payMethod:1,userId:t.getStorageSync("userInfo").id,phone:this.contacts};2==n?i.payMethod=2:1==n&&(i.payMethod=1),this.$req.put("goodsOrder/payment",i).then((function(n){if(n.data.timeStamp)t.requestPayment({provider:"wxpay",timeStamp:n.data.timeStamp,nonceStr:n.data.nonceStr,package:"prepay_id="+n.data.packageStr,signType:"MD5",paySign:n.data.paySign,success:function(n){t.showToast({title:"支付成功",icon:"none"}),setTimeout((function(){t.redirectTo({url:"/pages/order/list"})}),500)},fail:function(n){t.showToast({title:"支付失败,请重试",icon:"none"})}});else{if(e.$refs.popup.close(),500==n.code)return void t.showToast({title:"积分不足",icon:"none"});t.showToast({title:"积分支付成功",icon:"none"}),setTimeout((function(){t.redirectTo({url:"/pages/order/list"})}),500)}}))}else t.showToast({title:"请添加地址",icon:"none"})},init:function(){var n=this;this.$req.get("userAddress/acquisitionUserAddress",{userId:t.getStorageSync("userInfo").id}).then((function(t){var e=t.data,i=e.filter((function(t){return 1==t.isDefault}));if(i.length){var o=i[0];n.addressObj=JSON.parse(JSON.stringify(o)),n.city="".concat(o.provinceState,",").concat(o.city,",").concat(o.area),n.addressId=o.id,n.contacts=o.phoneNumber,n.address=o.addressLine}}))}}};n.default=e}).call(this,e("543d")["default"])},9903:function(t,n,e){"use strict";var i=e("3fdc"),o=e.n(i);o.a},ebc4:function(t,n,e){"use strict";(function(t,n){var i=e("4ea4");e("4812");i(e("66fd"));var o=i(e("0965"));t.__webpack_require_UNI_MP_PLUGIN__=e,n(o.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])}},[["ebc4","common/runtime","common/vendor"]]]);