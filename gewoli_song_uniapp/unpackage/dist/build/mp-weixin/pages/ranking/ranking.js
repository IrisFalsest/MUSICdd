(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ranking/ranking"],{"33fc":function(e,t,n){},"4fe6":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={data:function(){return{scrollTop:0,top3:[],rankingList:[],showPopup:!1,checkIndex:0,value:"",userInfo:{},shareParams:{path:"/pages/ranking/ranking?shareId="+e.getStorageSync("userInfo").id,title:"邀请您参加活动",imageUrl:"",desc:""},searchTxt:"",searchFlag:!1,popList:{},shopList:[],popupHeight:50,scrollY:0}},computed:{titleHeight:function(){return getApp().globalData.titleHeight},loginType:function(){return e.getStorageSync("loginType")}},watch:{showPopup:function(e,t){0==e&&(this.popupHeight=50)},searchTxt:function(e,t){""==e&&this.search()}},onLoad:function(t){console.log(t.shareId),t.shareId&&e.setStorageSync("shareId",t.shareId),this.getRankingList();var n=e.getStorageSync("userInfo").id;this.getInfo(n),this.templateList()},methods:{goPageDetails:function(t){e.showModal({title:"温馨提示",content:"您确定要选购商品吗？",confirmText:"立即购买",cancelText:"残忍拒绝",success:function(n){n.confirm?e.navigateTo({url:"/pages/goodDetails/goodDetails?id="+t}):n.cancel&&console.log("用户点击取消")}})},refScroll:function(e){this.scrollY=e.detail.scrollTop,this.scrollY>200&&(this.popupHeight=80),this.scrollY<200&&(this.popupHeight=50)},search:function(){var t=this,n={name:this.searchTxt,type:4};this.$req.get("ranking/acquisitionActivityRankingByTypeAndNameOrUserId",n).then((function(n){console.log(n),t.rankingList=n.data,e.setStorageSync("rankingList",t.rankingList),t.searchFlag=!0}))},getInfo:function(e){var t=this;this.$req.get("mobileEndUser/info?userId="+e).then((function(e){t.userInfo=e.data.user}))},ranking:function(){var t=e.getStorageSync("userInfo");if(3!=t.musiciansReviewStatus)e.showToast({title:"您还不是音乐人，请提交音乐人信息审核！",icon:"none"}),setTimeout((function(){e.navigateTo({url:"/pages/upUserInfo/upUserInfo?loginType=2"})}),1e3);else{var n={status:0,userHeat:0,userId:t.id,rankingType:4};this.$req.put("ranking",n).then((function(t){200==t.code&&e.showToast({title:"报名成功！",icon:"none"})}))}},templateList:function(){var e=this;this.$req.get("system/template/list?type=活动分享&templateName=我是音乐人").then((function(t){e.shareParams.imageUrl=t.rows[0].backgroundImage,e.shareParams.desc=t.rows[0].type,console.log(e.shareParams)}))},submit:function(){var t=this,n=this.userInfo.score;if(this.value>n)return e.showToast({title:"积分不足，您可以通过购买歌曲或商品获取积分",icon:"none"}),setTimeout((function(){e.switchTab({url:"/pages/tabbar/goods/goods"})}),1e3),!1;e.showLoading();var i={giver:this.userInfo.id,recipient:this.rankingList[this.checkIndex].userId,score:this.value};this.$req.put("mobileEndUser/rewardPoints",i,"form").then((function(n){if(e.showToast({title:n.msg,icon:"none"}),200==n.code){t.$req.get("mobileEndUser/info",{userId:t.userInfo.id}).then((function(n){t.userInfo=JSON.parse(JSON.stringify(n.data.user)),e.setStorageSync("userInfo",n.data.user)}));var i={userId:t.rankingList[t.checkIndex].userId,userHeat:t.value};t.$req.post("ranking/modifyHeat",i,"form").then((function(n){200==n.code&&(t.getRankingList(),t.value=""),e.showToast({title:n.msg,icon:"none"})}))}}))},showPop:function(t,n,i){var o=this;e.navigateTo({url:"/pages/leaderboardDetails/leaderboardDetails?index="+t+"&id="+n+"&userId="+i}),console.log(t),this.checkIndex=t;var a={rankingId:n,type:4};this.$req.get("ranking/acquisitionActivityRankingById",a).then((function(e){console.log(e),o.popList=e.data,o.shopList=e.data.goods}))},getRankingList:function(t){var n=this,i={name:this.searchTxt,type:4};this.$req.get("ranking/acquisitionActivityRankingByTypeAndNameOrUserId/",i).then((function(t){n.rankingList=t.data,e.setStorageSync("rankingList",n.rankingList),n.showPopup=!1,e.hideLoading()}))},scrollMain:function(e){this.scrollTop=e.detail.scrollTop}},onShareAppMessage:function(e){return{title:this.shareParams.title,path:this.shareParams.path,imageUrl:this.shareParams.imageUrl}}};t.default=n}).call(this,n("543d")["default"])},cd5e:function(e,t,n){"use strict";n.r(t);var i=n("4fe6"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t["default"]=o.a},cf7a:function(e,t,n){"use strict";n.r(t);var i=n("f635"),o=n("cd5e");for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);n("e76b");var s=n("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"e3581b68",null,!1,i["a"],void 0);t["default"]=r.exports},da8e:function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("4812");i(n("66fd"));var o=i(n("cf7a"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},e76b:function(e,t,n){"use strict";var i=n("33fc"),o=n.n(i);o.a},f635:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));var i={heads:function(){return n.e("components/heads/heads").then(n.bind(null,"3ce6"))},uSearch:function(){return n.e("uview-ui/components/u-search/u-search").then(n.bind(null,"3457"))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"6eef"))},uInput:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-input/u-input")]).then(n.bind(null,"c9bc"))},uWaterfall:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-waterfall/u-waterfall")]).then(n.bind(null,"d830"))},uLazyLoad:function(){return n.e("uview-ui/components/u-lazy-load/u-lazy-load").then(n.bind(null,"270e4"))}},o=function(){var e=this.$createElement;this._self._c},a=[]}},[["da8e","common/runtime","common/vendor"]]]);