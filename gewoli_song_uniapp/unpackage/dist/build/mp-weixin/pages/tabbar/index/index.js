(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabbar/index/index"],{"071a":function(t,e,n){"use strict";var i=n("36f6"),o=n.n(i);o.a},"1d11":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{swiperList:[],scrollTop:0,haveAcquisitionActivity:!1,acquisitionActivity:{},tabsOne:[{tName:"在售歌单",type:1}],tabs:[{tName:"热歌榜",type:2},{tName:"新歌榜",type:3}],rangKingList:[[],[],[]],rangKingList1:[[],[]],tIndex:0,pIndex:0,list:[{tName:"金牌制作人",type:1},{tName:"签约制作人",type:2},{tName:"新晋制作人",type:3}],yinYueRenlist:[{tName:"音乐人",type:4}],listMV:[{tName:"热门MV",type:1}],listlyp:[{tName:"录音棚",type:1}],FindStudioView:[],mvList:[],acquisitionRanking:[],MusicianList:[],userId:"",curItem:{},mvTypeList:[],play:!1}},components:{PlayBottom:function(){n.e("components/PlayBottom").then(function(){return resolve(n("7902"))}.bind(null,n)).catch(n.oe)}},filters:{timeFilter:function(t){return 1==t.toString().length&&(t="0"+t),t}},computed:{tabbar:function(){return getApp().globalData.tabbar},loginType:function(){return t.getStorageSync("loginType")},isSingleItem:function(){return 1===this.FindStudioView.length}},onShow:function(){this.getSongRanking(1),this.getSongRanking(2),this.getSongRanking(3),this.getFindStudioView(),this.Musician(),console.log(this.$globalDataAudio.audioCtx),null!=this.$globalDataAudio.audioCtx&&(this.play=!1,console.log("有实例"),this.play=!0),this.$refs.playBottomRef.updatePlayObj()},onLoad:function(){this.getAcquisitionActivity(),this.getFindStudioView(),this.getType(),this.getMv(0),this.changeTabp(0),this.getSwiper(),this.Musician(),this.getMvType(),this.userId=t.getStorageSync("userInfo").id},methods:{toDetails:function(e){t.navigateTo({url:"/pages/details/details?id="+e.userId})},open:function(e){t.navigateTo({url:"/pages/songBuying/songBuying?item="+JSON.stringify(e)}),this.curItem=e},scrollchange:function(t){console.log(t)},goPageMv:function(e){t.navigateTo({url:"/pages/mv-play/mv-play?item="+JSON.stringify(e)})},buy:function(e){var n=this,i=this;console.log(e);var o=this.curItem,a=t.getStorageSync("userInfo").roleType,s=t.getStorageSync("userInfo").musiciansSignStatus;if("2"==a&&"3"!==s)return t.showToast({title:"请签约后购买",icon:"none"}),void t.navigateTo({url:"/pages/upUserInfo/upExamine"});var r={userId:t.getStorageSync("userInfo").id,goodsId:o.id,phone:t.getStorageSync("userInfo").reviewPhone,payMethod:1};2==e?r.payMethod=2:1==e&&(r.payMethod=1),this.$req.put("song/order/payment",r).then((function(e){if(e.data.timeStamp)t.requestPayment({provider:"wxpay",timeStamp:e.data.timeStamp,nonceStr:e.data.nonceStr,package:"prepay_id="+e.data.packageStr,signType:"MD5",paySign:e.data.paySign,success:function(e){t.showToast({title:"支付成功",icon:"none"}),setTimeout((function(){n.toUrl("/pages/order/singOrderList")}),500),i.$refs.popup.close()},fail:function(e){t.showToast({title:"支付失败,请重试",icon:"none"}),i.$refs.popup.close()}});else{if(n.$refs.popup.close(),500==e.code)return void t.showToast({title:"积分不足",icon:"none"});t.showToast({title:"积分支付成功",icon:"none"}),setTimeout((function(){n.toUrl("/pages/order/singOrderList")}),500)}}))},playMp3:function(t,e,n){var i=encodeURIComponent(JSON.stringify(this.rangKingList[n]));this.toUrl("/pages/play/play?list=".concat(i,"&index=").concat(e))},playMp31:function(t,e,n){var i=encodeURIComponent(JSON.stringify(this.rangKingList1[n]));this.toUrl("/pages/play/play?list=".concat(i,"&index=").concat(e))},changeTab:function(t){console.log(t),this.tIndex=t},deleteFollow:function(e){var n=this,i={followUsers:e,userId:t.getStorageSync("userInfo").id};this.$req.post("follow/deleteFollow?followUsers="+i.followUsers+"&userId="+i.userId).then((function(e){200==e.code&&(t.showToast({title:"取消关注成功！",icon:"none"}),n.changeTabp(n.pIndex),n.Musician())}))},changeTabp:function(e){var n=this;this.pIndex=e;var i={type:e+1,userId:t.getStorageSync("userInfo").id};this.$req.get("ranking/acquisitionRanking?type="+i.type+"&userId="+i.userId).then((function(t){n.acquisitionRanking=t.data}))},Musician:function(){var e=this,n={type:4,userId:t.getStorageSync("userInfo").id};this.$req.get("ranking/acquisitionRanking?type="+n.type+"&userId="+n.userId).then((function(t){e.MusicianList=t.data}))},scrollMain:function(t){this.scrollTop=t.detail.scrollTop},getSongRanking:function(t){var e=this;this.$req.get("song/acquisitionSongRanking",{type:t}).then((function(n){var i=n.data;e.rangKingList[t-1]=i.slice(0,3),2!=t&&3!=t||(e.rangKingList1[t-2]=i.slice(0,3))}))},getAcquisitionActivity:function(){var e=this,n={userId:t.getStorageSync("userInfo").id};this.$req.get("activity/acquisitionActivity",n).then((function(t){var n=t.data;if(n.id){var i=!0,o=new Date,a=n.endTime.split("T")[0].split("-"),s=n.endTime.split("T")[1].split(":"),r=s[2],u=new Date(a[0],a[1]-1,a[2],s[0],s[1],r.split(".")[0]);if(o>u)i=!1;else{var c=u.getTime()-o.getTime(),l=Math.floor(c/864e5),g=c%864e5,d=Math.floor(g/36e5),p=g%36e5,f=Math.floor(p/6e4),h=p%6e4,m=Math.round(h/1e3);n.days=l,n.hours=d,n.minutes=f,n.seconds=m}1==n.status&&(i=!1),e.acquisitionActivity=n,e.haveAcquisitionActivity=i}}))},getType:function(){var t=this;this.$req.get("system/type/list?pageNum=1&pageSize=99").then((function(e){e.rows.unshift({typeName:"不限"}),t.mvTypeList=e.rows}))},getMv:function(t){var e=this;this.$req.get("song/acquisitionSong?songType="+t+"&userId="+this.userId).then((function(t){e.mvList=t.data}))},changeMv:function(t){this.getMv(t)},getFindStudioView:function(){var t=this;this.$req.get("recordingStudio/findStudioView").then((function(e){t.FindStudioView=e.data}))},userFollow:function(e){var n=this,i={userId:t.getStorageSync("userInfo").id,followUsers:e};this.$req.post("follow/userFollow",i,"form").then((function(e){200==e.code&&(t.showToast({title:"关注成功！",icon:"none"}),n.changeTabp(n.pIndex),n.Musician())}))},toPage:function(e){t.navigateTo({url:"/pages/tabbar/recording/details?id="+e})},getSwiper:function(){var t=this;this.$req.get("system/image/list").then((function(e){t.swiperList=e.rows}))},goPage:function(e){"/pages/producer/producer"==e&&t.navigateTo({url:e}),t.navigateTo({url:e})},getMvType:function(){var t=this;this.$req.get("system/type/list?pageNum=1&pageSize=99").then((function(e){e.rows.unshift({typeName:"热门MV"}),t.listMV=e.rows.map((function(t){return{tName:t.typeName,type:t.id}}))}))},audition:function(e,n,i){clearTimeout(this.$globalDataAudio.timer),this.$globalDataAudio.timer=null;var o=this.$globalDataAudio.audioCtx;o.src=e.songFileUrl,o.play(),this.$globalDataAudio.timer=setTimeout((function(){o.stop(),t.showModal({title:"提示",content:"试听结束，购买后可播放",success:function(t){t.confirm?console.log("用户点击确定"):t.cancel&&console.log("用户点击取消")}})}),25e3)}}};e.default=i}).call(this,n("543d")["default"])},"36f6":function(t,e,n){},"3d83":function(t,e,n){"use strict";n.r(e);var i=n("1d11"),o=n.n(i);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=o.a},"82d9":function(t,e,n){"use strict";n.r(e);var i=n("d1f7"),o=n("3d83");for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);n("071a");var s=n("f0c5"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"0f22e719",null,!1,i["a"],void 0);e["default"]=r.exports},d1f7:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}));var i={heads:function(){return n.e("components/heads/heads").then(n.bind(null,"3ce6"))},uIcon:function(){return n.e("uview-ui/components/u-icon/u-icon").then(n.bind(null,"7154"))},tTabs:function(){return n.e("components/tTabs/tTabs").then(n.bind(null,"977b"))},uEmpty:function(){return n.e("uview-ui/components/u-empty/u-empty").then(n.bind(null,"bfee"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"f8c6"))},uTabbar:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-tabbar/u-tabbar")]).then(n.bind(null,"d781"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.haveAcquisitionActivity?t._f("timeFilter")(t.acquisitionActivity.hours):null),i=t.haveAcquisitionActivity?t._f("timeFilter")(t.acquisitionActivity.minutes):null,o=t.haveAcquisitionActivity?t._f("timeFilter")(t.acquisitionActivity.seconds):null,a=t.__map(t.rangKingList,(function(e,n){var i=t.__get_orig(e),o=0==n?e.length:null;return{$orig:i,g0:o}})),s=t.__map(t.rangKingList1,(function(e,n){var i=t.__get_orig(e),o=t.tIndex==n?e.length:null;return{$orig:i,g1:o}})),r=t.acquisitionRanking.length,u=t.acquisitionRanking.length,c=u>0?t.acquisitionRanking.slice(0,4):null,l=t.MusicianList.length,g=t.MusicianList.length,d=g>0?t.MusicianList.slice(0,4):null,p=t.mvList.slice(0,6),f=t.mvList.length,h=t.FindStudioView.slice(0,2);t._isMounted||(t.e0=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.toDetails(n)},t.e1=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.userFollow(n.userId)},t.e2=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.deleteFollow(n.userId)},t.e3=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.toDetails(n)},t.e4=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.userFollow(n.userId)},t.e5=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.deleteFollow(n.userId)},t.e6=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.goPageMv(n)},t.e7=function(e,n){var i=arguments[arguments.length-1].currentTarget.dataset,o=i.eventParams||i["event-params"];n=o.item;return t.toPage(n.id)}),t.$mp.data=Object.assign({},{$root:{f0:n,f1:i,f2:o,l0:a,l1:s,g2:r,g3:u,l2:c,g4:l,g5:g,l3:d,l4:p,g6:f,l5:h}})},a=[]},f856:function(t,e,n){"use strict";(function(t,e){var i=n("4ea4");n("4812");i(n("66fd"));var o=i(n("82d9"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["f856","common/runtime","common/vendor"]]]);