(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/songBuying/songBuying"],{"034e":function(e,t,n){"use strict";n.r(t);var o=n("91b5"),a=n("c5a2");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("d450");var s=n("f0c5"),u=Object(s["a"])(a["default"],o["b"],o["c"],!1,null,"fec3a36a",null,!1,o["a"],void 0);t["default"]=u.exports},"91b5":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={heads:function(){return n.e("components/heads/heads").then(n.bind(null,"3ce6"))},uniPopup:function(){return n.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(n.bind(null,"f8c6"))}},a=function(){var e=this.$createElement;this._self._c},i=[]},"98f7":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("4812");o(n("66fd"));var a=o(n("034e"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},b812:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("4a78"),a={data:function(){return{scrollTop:0,groupValue:!1,phoneNumber:"",name:"",cardNo:"",curItem:{},code:"",codeValue:"获取验证码",codeFlag:!1}},methods:{radioChange:function(e){console.log(e.detail),this.groupValue=!this.groupValue},scrollMain:function(e){},getSendSms:function(){var t=this;if(this.phoneNumber){if(this.codeValue=60,this.codeFlag=!0,60===this.codeValue){this.codeValue=59;var n=setInterval((function(){t.codeValue>0?t.codeValue--:(clearInterval(n),t.codeValue="获取验证码",t.codeFlag=!1)}),1e3),o={phoneNumber:this.phoneNumber};this.$req.post("user/sendSms",o,"form").then((function(e){console.log(e)}))}}else e.showToast({title:"请填写手机号",icon:"none"})},open:function(){var t=this;if(this.name&&this.cardNo&&this.phoneNumber&&this.code)if(this.groupValue){var n={phoneNumber:this.phoneNumber,code:this.code};e.request({url:o.BASEURL+"/user/smsFlag",method:"GET",data:n,header:{Authorization:e.getStorageSync("token")||"","content-type":"application/x-www-form-urlencoded"},success:function(n){console.log(n.data.msg),"验证码正确"==n.data.msg&&t.auth(),e.showToast({title:n.data.msg,icon:"none"})}})}else e.showToast({title:"请阅读并勾选同意协议",icon:"none"});else e.showToast({title:"请填写全部信息",icon:"none"})},auth:function(){var t=this,n={cardNo:this.cardNo,name:this.name};this.$req.post("user/auth",n).then((function(n){"身份证号和姓名一致"==n.data.msg&&t.$refs.popup.open(),e.showToast({title:n.data.msg,icon:"none"})}))},buy:function(t){var n=this,o=this;console.log(t);var a=this.curItem,i=e.getStorageSync("userInfo").roleType,s=e.getStorageSync("userInfo").musiciansSignStatus;if("2"==i&&"3"!==s)return e.showToast({title:"请签约后购买",icon:"none"}),void e.navigateTo({url:"/pages/upUserInfo/upUserInfo"});var u={userId:e.getStorageSync("userInfo").id,goodsId:a.id,phone:e.getStorageSync("userInfo").reviewPhone,payMethod:1};2==t?u.payMethod=2:1==t&&(u.payMethod=1);this.$req.put("song/order/payment",u).then((function(t){if(t.data.timeStamp)e.requestPayment({provider:"wxpay",timeStamp:t.data.timeStamp,nonceStr:t.data.nonceStr,package:"prepay_id="+t.data.packageStr,signType:"MD5",paySign:t.data.paySign,success:function(t){e.showToast({title:"支付成功",icon:"none"}),setTimeout((function(){n.toUrl("/pages/order/singOrderList")}),500),o.$refs.popup.close()},fail:function(t){e.showToast({title:"支付失败,请重试",icon:"none"}),o.$refs.popup.close()}});else{if(n.$refs.popup.close(),500==t.code)return void e.showToast({title:"积分不足",icon:"none"});e.showToast({title:"积分支付成功",icon:"none"}),setTimeout((function(){n.toUrl("/pages/order/singOrderList")}),500)}}))},goPage:function(){e.navigateTo({url:"/pages/agreement/agreement"})}},onLoad:function(e){this.curItem=JSON.parse(e.item)}};t.default=a}).call(this,n("543d")["default"])},c5a2:function(e,t,n){"use strict";n.r(t);var o=n("b812"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},d450:function(e,t,n){"use strict";var o=n("f613"),a=n.n(o);a.a},f613:function(e,t,n){}},[["98f7","common/runtime","common/vendor"]]]);